{% extends 'base.html' %} {% load static %} {% block head %}
<link rel="stylesheet" href="{% static 'css/checkout.css' %}" />
{% endblock %} {% block content %}
<main>
<section>
  <form class="card" id="white-card" method="POST" action={% url 'checkout' %}>
    {% csrf_token %}
    <div class="form-group">
      <label for="name">
        <img src="{% static 'images/checkout/Person.png' %}" alt="Person Icon" />
        Name</label
      >
      <input
        id="beige-card"
        class="card"
        type="text"
        name="name"
        placeholder="Full Name"
        required
      />
    </div>

    <div class="form-group">
      <label for="email">
        <img src="{% static 'images/checkout/email.png' %}" alt="Email Icon" />
        Email</label
      >
      <input
        id="beige-card"
        class="card"
        type="email"
        name="email"
        placeholder="your@email.com"
        required
      />
    </div>

    <div class="form-group">
      <label for="phone">
        <img src="{% static 'images/checkout/phone.png' %}" alt="Phone Icon" />
        Phone</label
      >
      <input
        id="beige-card"
        class="card"
        type="tel"
        name="phone"
        pattern="\d{3}-\d{3}-\d{4}"
  title="Phone number must be in the format 123-456-7890"
        maxlength='12'
        placeholder="(555) 123-4567"
      />
    </div>

    <div class="form-group">
      <label for="address">
        <img src="{% static 'images/checkout/house.png' %}" alt="House Icon" />
        Address</label
      >
      <input
        id="beige-card"
        class="card"
        type="text"
        name="address"
        placeholder="Street Address"
        required
      />
    </div>

    <div class="form-row">
      <div class="form-group half">
        <label for="city">
          <img src="{% static 'images/checkout/city.png' %}" alt="City Icon" />
          City</label
        >
        <input
          type="text"
          id="beige-card"
          class="card"
          name="city"
          placeholder="City"
          required
        />
      </div>

      <div class="form-group quarter">
        <label for="state">
          <img src="{% static 'images/checkout/flag.png' %}" alt="Flag Icon" />
        </label>
        <input
          type="text"
          id="beige-card"
          class="card"
          name="state"
          maxlength="2"
          pattern="[A-Z]{2}"
          placeholder="ST"
          required
        />
      </div>

      <div class="form-group quarter">
        <label for="zip">
          <img src="{% static 'images/checkout/pin.png' %}" alt="Location Pin Icon" />
        </label>
        <input
          type="text"
          id="beige-card"
          class="card"
          name="zip"
          maxlength='5'
          placeholder="Zip"
          required
        />
      </div>
    </div>

</section>

<section class="card" id="shipping">
  <h2>Shipping Method</h2>
  <div class="shipping-card-container">
  <label class="shipping-card" id="white-card">
    <input type="radio" name="shipping_method" value="standard" data-price="4.99" required />
    <div class="shipping-info">
      <img src="{% static 'images/checkout/deliverytruck.png' %}" alt="Delivery Truck Icon" />
      <div>
        <h3>Standard Shipping</h3>
        <p>3–5 business days.</p>
      </div>
      <div>$4.99</div>
    </div>
  </label>

  <label class="shipping-card" id="white-card">
    <input type="radio" name="shipping_method" value="express" data-price="14.99" />
    <div class="shipping-info">
      <img src="{% static 'images/checkout/lightning.png' %}" alt="Lightning Icon" />
      <div>
        <h3>Express Shipping</h3>
        <p>1–2 business days.</p>
      </div>
      <div>$14.99</div>
    </div>
  </label>

  <label class="shipping-card" id="white-card">
    <input type="radio" name="shipping_method" value="eco" data-price="2.99" />
    <div class="shipping-info">
      <img src="{% static 'images/checkout/leaf.png' %}" alt="Leaf Icon" />
      <div>
        <h3>Eco Delivery</h3>
        <p>5–7 days, zero emissions</p>
      </div>
      <div>$2.99</div>
    </div>
  </label>
</div>
</section>

<section id="payment" >
    <div class="card" id="white-card">
      <h2>Payment</h2>
    <div class="form-group">
      <label for="cardholder-name">
        <img src="{% static 'images/checkout/folder.png' %}" alt="Folder Icon" />
        Cardholder Name</label>
      <input type="text" id="credit-card" name="cardholder_name" placeholder='Name on Card' required />
    </div>
    
    <div class="form-group">
      <label for="card-number">
        <img src="{% static 'images/checkout/card.png' %}" alt="Card Icon" />
        Card Number</label>
      <input type="text" id="credit-card" 
      name="card_number" maxlength="19" 
      pattern="\d{4}[\s]?\d{4}[\s]?\d{4}[\s]?\d{4}" 
      placeholder='1234 5678 9012 3456' required />
    </div>

    <div class="form-row">
        <div class="form-group half">
            <label for="expiration">
            <img src="{% static 'images/checkout/calendar.png' %}" alt="Calendar Icon" />
            Expiration Date</label>
            <input type="text" id="credit-card"
            name="expiration" pattern="^(0[1-9]|1[0-2])\/\d{2}$"
            maxlength='5'
            placeholder="MM/YY" required />
        </div>

        <div class="form-group half">
        <label for="cvv">
            <img src="{% static 'images/checkout/lock.png' %}" alt="Lock Icon" />
            CVV</label>
        <input type="text" id="credit-card" name="cvv" maxlength="3" placeholder='CVV' required />
        </div>

        <img id='cardicons' src="{% static 'images/checkout/cardicons.png' %}" alt="Card Payment Icons" />
    </div>
    
    <div class="price-list">
  <h3>Total:</h3>
  <div id="total-price">${{ total|floatformat:2 }}</div> <!-- optional live update -->
</div>
    
    <button class="cta-button" type="submit">Place Order</button>
</div>
</section>
</form>
</main>
<script>
    const baseTotal = parseFloat("{{ total|floatformat:2 }}");

  const shippingRadios = document.querySelectorAll('input[name="shipping_method"]');
  const totalDiv = document.getElementById('total-price'); // optional display element

  shippingRadios.forEach(radio => {
    radio.addEventListener('change', () => {
      const shippingPrice = parseFloat(radio.dataset.price);
      // optionally display or update a total
      const newTotal = baseTotal + shippingPrice;
    totalDiv.textContent = `$${newTotal.toFixed(2)}`;
    });
  });
</script>
{% endblock %}
